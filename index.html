<html class="translated-ltr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=0.8, minimal-ui">
	<meta name="theme-color" content="#36393E">

	<meta name="description" content="244v234">
	<title>0971282336</title>
<style>

/* Global */
body {
	background: #ffffff;
	color: #000000;
	font-family: sans-serif;
	margin: 0;
}

h1 {
	font-size: 1.7rem;
    margin-top: 1rem;
    background: #e3e3e3;
    color: #363636;
    padding: 0.2em 1em;
    border-radius: 3px;
	border-left: solid #363636 5px;
    font-weight: 100;
}

h2 {
	font-size: 1.1rem;
    margin-top: 1rem;
    background: #e3e3e3;
    color: #363636;
    padding: 0.4em 1.8em;
    border-radius: 3px;
	border-left: solid #363636 5px;
    font-weight: 100;
}

table{
	border-collapse: collapse;
}

label{
	line-height: 38px;
}

p{
	margin: 0.5em 0;
}

.left {
	float: left;
}
.right {
	float: right;
}
.bold {
	font-weight: bold;
}
.red{
	color: #ffffff;
}
.green{
	color:#43B581;
}
.clear {
	clear: both;
}
.centered{
	text-align: center;
}
.select{
	width: 98px !important;
	padding: 0 !important;
}
.selected{
	background: #54d64d;
}
.status{
	width: 120px;
	padding-left: 8px;
}
.labelFix {
	line-height: 44px;
}
.clickable{
	cursor: pointer;
}
.settingName{
	text-transform: uppercase;
	font-weight: bold;
	text-decoration: underline;
}

#status {
	text-align: center;
	text-transform: capitalize;
	padding: 5px;
	color: #fff;
	position: sticky;
	top: 0;
	z-index: 99;
}

#closeError{
	float: right;
	color: #fff;
	padding: 0px 10px;
	cursor: pointer;
}

#dieu-khoan {
    width: 50%;
    height: 100px;
    border: 1px solid #000;
}

footer {
	font-size: .95em;
	text-align: center;
	margin-top: 3em;
	margin-bottom: 3em;
}

/* ===== CHECKBOX ===== */
/* Customize the label (the container) */
.checkBoxContainer {
  display: block;
  position: relative;
  padding-left: 35px;
  margin-bottom: 12px;
  cursor: pointer;
  font-size: 22px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  height: 32px;
}

/* Hide the browser's default checkbox */
.checkBoxContainer input {
  position: absolute;
  opacity: 0;
  cursor: pointer;
}

/* Create a custom checkbox */
.checkmark {
  position: absolute;
  top: 8px;
  left: 0;
  height: 28px;
  width: 28px;
  background-color: #7a7a7a;
  border-radius: 4px;
}

/* Create the checkmark/indicator (hidden when not checked) */
.checkmark:after {
  content: "";
  position: absolute;
  display: none;
}

/* Show the checkmark when checked */
.checkBoxContainer input:checked ~ .checkmark:after {
  display: block;
}


.checkBoxContainer .checkmark:after {
  left: 10px;
  top: 7px;
  width: 4px;
  height: 10px;
  border: solid white;
  border-width: 0 3px 3px 0;
  -webkit-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  transform: rotate(45deg);
}

/* ERROR */
.hide {
	display: none;
}

.show {
	display: block !important;
	animation-name: fadeIn;
	animation-duration: 1s;
}

@keyframes fadeIn {
	0%   {opacity: 0;}
	100% {opacity: 1;}
}


hr {
	background: #3e4146;
}

a {
	color: #5281bb;
    text-decoration: none;
}

a:hover {
	color: #95b8e4;
}

li{
	margin: 4px 0;
}

/* Meter */
.meter_background{
	background: #42464D;
	width: 100%;
	word-break: normal;
	min-width: 100px;
}
.meter_forground{
	color: #fff;
	padding: 4px 0;
	/* + one of the colors below
	(width will be set by the JS) */
}
.meter_green{
	background: #43B581;
}
.meter_orange{
	background: #FAA61A;
}
.meter_red{
	background: #F04747;
}
.meter_value{
	padding-left: 8px;
}


/* Tables */
table {
	width: 100%;
	min-width: 400px;
	margin-bottom: 2em;
}

td{
	word-break: break-all;
}

th{
	word-break: break-word;
}

th, td {
    padding: 10px 6px;
	text-align: left;
    border-bottom: 1px solid #5d5d5d;
}

@media screen and (max-width: 820px) {
	#apTable .id,
	#apTable .enc,
	#apTable .mac,
	#apTable .vendor,
	#apTable .name,

	#stTable .id,
	#stTable .pkts,
	#stTable .lastseen,
	#stTable .mac,

	#nTable .id,
	#nTable .vendor,
	#nTable .ap,
	#nTable .mac,

	#passwordTable .verify,

	#ssidTable .id	{
	  display: none;
	}

	.meter_background{
		min-width: 45px;
	}
}

nav {
	display: block;
	background: #ffffff;
	font-weight: bold;
	padding: 0 10px;
}
  
nav a {
	color: inherit;
	padding: 0 .5em;
}

.menu {
	list-style-type: none;
	margin: 0;
	padding: 0;
	margin: 0 auto;
	display: flex;
	flex-direction: row;
	display:block;
}

.menu li {
	margin: 10px 20px 10px 0;
	display: inline-block;
}

.menu li:last-child {
	float: right;
}

/* Inputs and buttons */
.upload-script, .button, button, input[type="submit"], input[type="reset"], input[type="button"] {
	display: inline-block;
	height: 38px;
	padding: 0 20px;
	color:#fff;
	text-align: center;
	font-size: 11px;
	font-weight: 600;
	line-height: 38px;
	letter-spacing: .1rem;
	text-transform: uppercase;
	text-decoration: none;
	white-space: nowrap;
	background: #747780;
	border-radius: 4px;
	border: none;
	cursor: pointer;
	box-sizing: border-box;
}

button:hover, input[type="submit"]:hover, input[type="reset"]:hover, input[type="button"]:hover {
	background: #5170cf;
}
button:active, input[type="submit"]:active, input[type="reset"]:active, input[type="button"]:active {
	transform: scale(.93);
}
button:disabled:hover, input[type="submit"]:disabled:hover, input[type="reset"]:disabled:hover, input[type="button"]:disabled:hover {
	background: white;
	cursor: not-allowed;
	opacity: 0.40;
	filter: alpha(opacity=40);
	transform: scale(1);
}
button::-moz-focus-inner {
  border: 0;
}
/* Forms */
input[type="email"], input[type="number"], input[type="search"], input[type="text"], input[type="tel"], input[type="url"], input[type="password"], textarea, select {
	height: 38px;
	padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */
	background-color: #757575;
	border-radius: 4px;
	box-shadow: none;
	box-sizing: border-box;
	color: #ffffff;
	border: none;
	width: 5em;
}

input[type="text"]{
	width: 10em;
}

.setting {
	width: 100% !important;
	max-width: 284px !important;
}

input[type="file"] {
    display: none;
}

/* ==== GRID SYSTEM ==== */
.container {
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  max-width: 1140px;
}

.row {
  position: relative;
  width: 100%;
}

.row [class^="col"] {
  float: left;
  margin: 0.25rem 2%;
  min-height: 0.125rem;
}

.col-1,
.col-2,
.col-3,
.col-4,
.col-5,
.col-6,
.col-7,
.col-8,
.col-9,
.col-10,
.col-11,
.col-12 {
  width: 96%;
}

.row::after {
	content: "";
	display: table;
	clear: both;
}

.hidden-sm {
  display: none;
}

@media only screen and (min-width: 24em) {
  .col-1 {
    width: 4.33%;
  }

  .col-2 {
    width: 12.66%;
  }

  .col-3 {
    width: 21%;
  }

  .col-4 {
    width: 29.33%;
  }

  .col-5 {
    width: 37.66%;
  }

  .col-6 {
    width: 46%;
  }

  .col-7 {
    width: 54.33%;
  }

  .col-8 {
    width: 62.66%;
  }

  .col-9 {
    width: 71%;
  }

  .col-10 {
    width: 79.33%;
  }

  .col-11 {
    width: 87.66%;
  }

  .col-12 {
    width: 96%;
  }

  .hidden-sm {
    display: block;
  }
}

</style>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2681486354588893"
     crossorigin="anonymous"></script>
</head>
<body>

<div id="content">
<h1>Công Tơ Điện Thông Minh</h1>
<p>Công tơ điện tử là thiết bị đo công suất tiêu thụ điện sử dụng MCU (esp8266 + pzem 004t) để lập trình, đo, tính toán và lưu trữ dữ liệu theo thời gian thực.<br>
Bên cạnh đó công tơ điện tử còn có khả năng kết nối truyền thông với các thiết bị khác như điện thoại, máy tính bảng, PC, Laptop thông qua dịch vụ free của bên thứ ba là google sheet.<br>
Lưu ý công tơ điện tử này chỉ mang tính chất tham khảo, không dùng làm cắn cứ để tranh luận về lượng điện tiêu thụ giữa bạn và EVN.</span><br>
Sự <span style=color:blue>chênh lệch số điện tiêu thụ phụ thuộc vào ngày chốt số, giờ chốt số giữa công tơ điện thông minh và công tơ điện của EVN</span>.</p>
<span style=color:red>Đây là dự án miễn phí, được xây dựng và phát triển bởi Nguyễn Vượng, mọi ý kiến đóng góp hoặc cần giải đáp vui lòng liên hệ zalo 0971282336</span>.<br><br>
<img width="20%" src="chiso.jpg"></img><img width="20%" src="chiso.PNG"></img><br>
<h3>Chuẩn Bị Phần Cứng</h3>
- Bạn cần có máy tính để bàn hoặc laptop.<br>
- Mạch ESP8266, bạn có thể chọn loại có màn hình hoặc không màn hình.<br>
Link mua ESP8266 trên shopee: <a href="https://shopee.vn/search?keyword=esp8266%20oled">https://shopee.vn/esp8266-20oled</a><br>
- Mạch Pzem 004T v3.0 (cảm biến dòng khép kín).<br>
Link mua Pzem 004T trên shopee: <a href="https://shopee.vn/search?keyword=pzem004t">https://shopee.vn/pzem004t</a><br>
- Mỏ hàn thiếc hoặc ra quán điện thoại nhờ hàn hộ theo Sơ đồ dưới (phí ~ 30k):<br><br>
<img width="70%" src="sodo.jpg"></img><br><br>
<h3>Tạo ID Google Sheet</h3>
Các bạn bấm vào link này để tạo ID bảng tính của google sheet <a href="https://docs.google.com/spreadsheets/create">https://docs.google.com/spreadsheets/create</a><br>
Bạn copy toàn bộ nội dung trong file ==> <a href="https://github.com/npbk21/congtodien/raw/main/App%20Script.txt">App Script.txt</a>
<h3>Lệnh Cài Đặt Thiết Bị</h3>
<p>Sau khi nạp xong phần mềm cho thiết bị (lần sử dụng đầu tiên), bạn phải thực hiện lần lượt các lệnh dưới để thiết bị có thể hoạt động.<br>
<br><li>Thay đổi ID google sheet</li>
<p>- Google sheet là dịch vụ hoàn toàn miễn phí của google, giúp bạn theo dõi qua điện thoại các chỉ số mà thiết bị đo và tính toán được theo thời gian thực.<br>
- Mỗi một google sheet sẽ có một ID riêng biệt, khi bạn thay đổi App Script thì ID này cũng sẽ thay đổi.<br>
- Cách tạo ID google sheet bạn xem hướng dẫn phía trên.<br>
- Muốn nhập ID cho lần đầu khởi chạy hoặc thay ID mới cho thiết bị, bạn nhập: <span style=color:red>idmoi</span><span style=color:blue>chuỗiIDcủabạn</span><br>
Ví dụ chuỗi mới là AKfycbxiL7rmnBRa0txRGtxwQeX2b12nb6g0hM9u<br>
Thì các bạn nhập <span style=color:red>idmoi</span><span style=color:blue>AKfycbxiL7rmnBRa0txRGtxwQeX2b12nb6g0hM9u</span><br></p>
<br><li>Thay đổi theo giá điện mới của EVN</li>
- Từ 15/5/2024, giá điện sẽ được xét duyệt thay đổi 3 tháng một lần nếu giá đầu vào thay đổi trên 3%.<br>
- Bạn truy cập link này để trả cứu giá điện mới của EVN: <a href="https://www.evn.com.vn/c3/calc/Cong-cu-tinh-hoa-don-tien-dien-9-172.aspx">https://www.evn.com.vn/c3/calc/Cong-cu-tinh-hoa-don-tien-dien-9-172.aspx</a><br>
- Để thay đổi giá điện các bậc 1, 2, 3, 4, 5, 6 bạn nhập lần lượt các lệnh sau: <span style=color:red>bacmot</span><span style=color:blue>XXXX</span>, <span style=color:red>bachai</span><span style=color:blue>XXXX</span>, <span style=color:red>bacba</span><span style=color:blue>XXXX</span>, <span style=color:red>bacbon</span><span style=color:blue>XXXX</span>, <span style=color:red>bacnam</span><span style=color:blue>XXXX</span>, <span style=color:red>bacsau</span><span style=color:blue>XXXX</span><br>
- <span style=color:blue>XXXX</span> là giá điện mới của từng bậc.<br>
<br><li>Thay đổi thành điện một giá</li>
- Với những bạn kinh doanh nhà trọ, muốn tính tiền điện tất cả các số điện theo cùng một giá.<br>
- Bạn nhập: <span style=color:red>dienmotgia</span><span style=color:blue>XXXX</span><br>
- <span style=color:blue>XXXX</span> là giá mà bạn muốn áp dụng<br>
- Muốn quay lại cách tính điện 6 bậc của EVN, bạn nhập: <span style=color:red>diensinhhoat</span><br>
<br><li>Thay đổi ngày chốt số</li>
- Thiết bị sẽ chốt số điện hàng tháng vào 23giờ59 của ngày mà bạn cài đặt.<br>
- Bạn nhập: <span style=color:red>ngaychotso</span><span style=color:blue>XX</span><br>
- <span style=color:blue>XX</span> là ngày bạn muốn chốt số điện.<br>
<br><li>Thay đổi thời gian truyền dữ liệu</li>
- Mặc định 7000 (miligiây) thiết bị sẽ chuyển màn hình và truyền dữ liệu lên google sheet một lần.<br>
- Bạn nhập <span style=color:red>chuyenmanhinh</span><span style=color:blue>XXXX</span><br>
- Cứ sau <span style=color:blue>XXXX</span> mili giây thiết bị sẽ truyền dữ liệu một lần.<br>

<h3>Nạp Phần Mềm Cho Thiết Bị</h3>
<li>Tải Driver, chương trình ESP8266Flasher và phần mềm congtodien.bin</li> 
<p> - Driver cho máy tính, tải về <a href="https://github.com/npbk21/congtodien/raw/main/CH34x_Install_Windows_v3_4.EXE">tại đây.</a></p>
<p> - ESP8266Flasher cho Windows x86 (32 bit), tải về <a href="https://github.com/nodemcu/nodemcu-flasher/raw/master/Win32/Release/ESP8266Flasher.exe">tại đây.</a></p>
<p> - ESP8266Flasher cho Windows x64 (64 bit), tải về <a href="https://github.com/ngocthuong234/ngocthuong234/raw/main/ESP8266Flasher.exe">tại đây.</a></p>
<p> - Phần mềm đăng ký key cho thiết bị contodien.bin, tải về <a href="https://github.com/npbk21/congtodien/raw/main/congtodien.bin">tại đây.</a></p>
<li>Cài Driver sau đó mở chương trình ESP8266Flasher.exe</li><br>
<li>Kết nối thiết bị với máy tình bằng dây cáp USB</li><br>
<img width="40%" src="flash1.jpg"></img><br><br>
<li>Chọn vào "Config" - sau đó bấm vào bánh răng giống như hình dưới. Chọn file KeyServerSing.bin bạn vừa tải về.</li><br>
<img width="40%" src="flash2.jpg"></img><br><br>
<li>Chọn vào "Operation" - sau đó bấm vào COM port, chọn COM của bạn.</li><br>
<li>Bấm vào FLASH giống như hình dưới</li><br>
<img width="40%" src="flash3.jpg"></img><br><br>
<li>Chờ chương trình nạp xong và hiển thị dấu tích màu xanh giống như hình dưới là xong.</li><br>
<img width="40%" src="flash4.jpg"></img><br><br>
<li>Sau khi nạp xong, bạn cấp nguồn cho thiết bị, và truy cập vào wifi <span style=color:red>CongToDien</span> do thiết bị phát ra.</li><br>
<li>Bạn mở trình duyệt web rồi truy cập 192.168.4.1</li><br>
<img width="20%" src="caidatwifi.jpg"></img><br><br>
<li>Bạn ghi nhớ địa chỉ MAC được hiển thị trên màn hình, sau đó chọn mạng wifi nhà bạn, nhập chính xác mật khẩu và bấm "Kết Nối" để thiết bị kết nối với wifi nhà bạn.</li><br>
<li>Bạn dùng điện thoại android vào CHplay cài ứng dụng IP tool để xem địa chỉ IP nội bộ của công tơ điện.</li><br>
<li>Sau khi đã biết được IP nội bộ của công tơ điện, bạn vào trình duyệt web nhập địa chỉ IP nội bộ để tiến hành cài đặt lệnh cho lần đầu sử dụng theo hướng dẫn ở trên.</li><br>
<br><br>
</div>
</body></html>
