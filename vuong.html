<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hiển thị Dữ liệu từ ESP8266</title>
    <!-- Thêm Firebase App (core SDK) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <!-- Thêm Firebase Realtime Database SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
      body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; }
      .data-item { font-size: 1.2em; margin: 10px; }
    </style>
  </head>
  <body>
    <h1>Dữ liệu từ ESP8266</h1>
    <div class="data-item">Công suất EVN: <span id="CongSuatEVN">Đang tải...</span> W</div>
    <div class="data-item">Công suất Hóa lưới: <span id="CongSuatHoaLuoi">Đang tải...</span> W</div>
    <div class="data-item">Công suất Cán đột: <span id="CongSuatCanDot">Đang tải...</span> W</div>
    <div class="data-item">Hóa lưới cao nhất: <span id="HoaLuoiCaoNhat">Đang tải...</span> W</div>
    <div class="data-item">Hóa lưới hôm nay: <span id="HoaLuoiHomNay">Đang tải...</span> W</div>
    <div class="data-item">Energy Hóa lưới: <span id="energyHoaLuoi">Đang tải...</span> Wh</div>
    <div class="data-item">Số hôm nay: <span id="SoHomNay">Đang tải...</span></div>
    <div class="data-item">Voltage: <span id="voltage">Đang tải...</span> V</div>
    <div class="data-item">Current I: <span id="currentI">Đang tải...</span> A</div>
    <div class="data-item">Tần số: <span id="TanSo">Đang tải...</span> Hz</div>
    
    <script>
      // Cấu hình Firebase: thay các giá trị theo dự án của bạn
      var firebaseConfig = {
        apiKey: "AIzaSyCNrATohxVSGXWu04M9NmjkyJBvAE_ArEI",
        authDomain: "congtodien-3ab2b.firebaseapp.com",
        databaseURL: "https://congtodien-3ab2b-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "congtodien-3ab2b",
        storageBucket: "congtodien-3ab2b.appspot.com",
        messagingSenderId: "605873453267",
        appId: "1:605873453267:web:c2feb364cc48a44493fc26"
      };
      // Khởi tạo Firebase
      firebase.initializeApp(firebaseConfig);

      // Lấy tham chiếu đến node "/esp8266"
      var sensorRef = firebase.database().ref("/esp8266");

      // Lắng nghe thay đổi dữ liệu và cập nhật giao diện
      sensorRef.on("value", function(snapshot) {
        var data = snapshot.val();
        if (data) {
          document.getElementById("CongSuatEVN").textContent = data.CongSuatEVN;
          document.getElementById("CongSuatHoaLuoi").textContent = data.CongSuatHoaLuoi;
          document.getElementById("CongSuatCanDot").textContent = data.CongSuatCanDot;
          document.getElementById("HoaLuoiCaoNhat").textContent = data.HoaLuoiCaoNhat;
          document.getElementById("HoaLuoiHomNay").textContent = data.HoaLuoiHomNay;
          document.getElementById("energyHoaLuoi").textContent = data.energyHoaLuoi;
          document.getElementById("SoHomNay").textContent = data.SoHomNay;
          document.getElementById("voltage").textContent = data.voltage;
          document.getElementById("currentI").textContent = data.currentI;
          document.getElementById("TanSo").textContent = data.TanSo;
        }
      }, function(error) {
        console.error("Lỗi khi lấy dữ liệu: " + error.code);
      });
    </script>
  </body>
</html>
